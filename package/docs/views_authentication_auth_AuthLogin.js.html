<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>views/authentication/auth/AuthLogin.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AdditionalDetails.html">AdditionalDetails</a><ul class='methods'><li data-type='method'><a href="module-AdditionalDetails.html#~AdditionalDetails">AdditionalDetails</a></li><li data-type='method'><a href="module-AdditionalDetails.html#~AdditionalDetails">AdditionalDetails</a></li></ul></li><li></li><li><a href="module-ApprovalForm.html">ApprovalForm</a><ul class='methods'><li data-type='method'><a href="module-ApprovalForm.html#~ApprovalForm">ApprovalForm</a></li><li data-type='method'><a href="module-ApprovalForm.html#~ApprovalForm">ApprovalForm</a></li></ul></li><li></li><li><a href="module-EmployeeVisitForm.html">EmployeeVisitForm</a><ul class='methods'><li data-type='method'><a href="module-EmployeeVisitForm.html#~EmployeeVisitForm">EmployeeVisitForm</a></li><li data-type='method'><a href="module-EmployeeVisitForm.html#~EmployeeVisitForm">EmployeeVisitForm</a></li><li data-type='method'><a href="module-EmployeeVisitForm.html#~calculateDuration">calculateDuration</a></li><li data-type='method'><a href="module-EmployeeVisitForm.html#~calculateDuration">calculateDuration</a></li><li data-type='method'><a href="module-EmployeeVisitForm.html#~formatTimestamp">formatTimestamp</a></li><li data-type='method'><a href="module-EmployeeVisitForm.html#~formatTimestamp">formatTimestamp</a></li><li data-type='method'><a href="module-EmployeeVisitForm.html#~stripNonEnglish">stripNonEnglish</a></li><li data-type='method'><a href="module-EmployeeVisitForm.html#~stripNonEnglish">stripNonEnglish</a></li></ul></li><li></li><li><a href="module-SaveandHold.html">SaveandHold</a><ul class='methods'><li data-type='method'><a href="module-SaveandHold.html#~SaveandHold">SaveandHold</a></li><li data-type='method'><a href="module-SaveandHold.html#~SaveandHold">SaveandHold</a></li><li data-type='method'><a href="module-SaveandHold.html#~calculateDuration">calculateDuration</a></li><li data-type='method'><a href="module-SaveandHold.html#~calculateDuration">calculateDuration</a></li><li data-type='method'><a href="module-SaveandHold.html#~formatTimestamp">formatTimestamp</a></li><li data-type='method'><a href="module-SaveandHold.html#~formatTimestamp">formatTimestamp</a></li><li data-type='method'><a href="module-SaveandHold.html#~getToColumnHtml">getToColumnHtml</a></li><li data-type='method'><a href="module-SaveandHold.html#~getToColumnHtml">getToColumnHtml</a></li></ul></li><li></li><li><a href="module-components_Roadmap.html">components/Roadmap</a><ul class='methods'><li data-type='method'><a href="module-components_Roadmap.html#~Roadmap">Roadmap</a></li></ul></li><li><a href="module-src_components_UIShowcase.html">src/components/UIShowcase</a><ul class='methods'><li data-type='method'><a href="module-src_components_UIShowcase.html#~UIShowcase">UIShowcase</a></li></ul></li><li><a href="module-src_components_authentication_OtpVerification.html">src/components/authentication/OtpVerification</a><ul class='methods'><li data-type='method'><a href="module-src_components_authentication_OtpVerification.html#~addTrustedDevice">addTrustedDevice</a></li><li data-type='method'><a href="module-src_components_authentication_OtpVerification.html#~generateDeviceFingerprint">generateDeviceFingerprint</a></li><li data-type='method'><a href="module-src_components_authentication_OtpVerification.html#~getDeviceInfo">getDeviceInfo</a></li><li data-type='method'><a href="module-src_components_authentication_OtpVerification.html#~removeTrustedDevice">removeTrustedDevice</a></li></ul></li><li><a href="module-src_components_ui.html">src/components/ui</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui.html#~AnimatedSlide">AnimatedSlide</a></li><li data-type='method'><a href="module-src_components_ui.html#~CardStyle">CardStyle</a></li></ul></li><li></li><li></li><li></li><li><a href="module-src_components_ui_Alerts.html">src/components/ui/Alerts</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Alerts.html#~Alerts">Alerts</a></li></ul></li><li><a href="module-src_components_ui_Avatar.html">src/components/ui/Avatar</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Avatar.html#~Avatar">Avatar</a></li></ul></li><li><a href="module-src_components_ui_Badge.html">src/components/ui/Badge</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Badge.html#~Badge">Badge</a></li></ul></li><li><a href="module-src_components_ui_Button.html">src/components/ui/Button</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Button.html#~Button">Button</a></li><li data-type='method'><a href="module-src_components_ui_Button.html#~ButtonGroup">ButtonGroup</a></li><li data-type='method'><a href="module-src_components_ui_Button.html#~NavigationContainer">NavigationContainer</a></li></ul></li><li><a href="module-src_components_ui_Card.html">src/components/ui/Card</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Card.html#~Card">Card</a></li></ul></li><li><a href="module-src_components_ui_Checkbox.html">src/components/ui/Checkbox</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Checkbox.html#~Checkbox">Checkbox</a></li></ul></li><li><a href="module-src_components_ui_DialogBox.html">src/components/ui/DialogBox</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_DialogBox.html#~DialogBox">DialogBox</a></li></ul></li><li><a href="module-src_components_ui_Dropdown.html">src/components/ui/Dropdown</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Dropdown.html#~Dropdown">Dropdown</a></li></ul></li><li><a href="module-src_components_ui_Input.html">src/components/ui/Input</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_Input.html#~Input">Input</a></li></ul></li><li><a href="module-src_components_ui_Pagination.html">src/components/ui/Pagination</a></li><li><a href="module-src_components_ui_PriorityIcon.html">src/components/ui/PriorityIcon</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_PriorityIcon.html#~PriorityIcon">PriorityIcon</a></li></ul></li><li><a href="module-src_components_ui_TextArea.html">src/components/ui/TextArea</a><ul class='methods'><li data-type='method'><a href="module-src_components_ui_TextArea.html#~TextArea">TextArea</a></li></ul></li><li><a href="module-src_layouts_full_header_Profile.html">src/layouts/full/header/Profile</a></li><li><a href="module-src_pages_Inbox_Inbox.html">src/pages/Inbox/Inbox</a></li><li><a href="module-src_services_EnhancedDynamicDecryption.html">src/services/EnhancedDynamicDecryption</a><ul class='methods'><li data-type='method'><a href="module-src_services_EnhancedDynamicDecryption.html#~base64ToArrayBuffer">base64ToArrayBuffer</a></li><li data-type='method'><a href="module-src_services_EnhancedDynamicDecryption.html#~getAuthHeaders">getAuthHeaders</a></li></ul></li><li><a href="module-src_views_authentication_auth_AuthLogin.html">src/views/authentication/auth/AuthLogin</a></li><li><a href="module-src_views_authentication_auth_encryption.html">src/views/authentication/auth/encryption</a><ul class='methods'><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.authenticateUser">authenticateUser</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.decryptGCM">decryptGCM</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.encryptECB">encryptECB</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.getDecryptKeyFromCookies">getDecryptKeyFromCookies</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.getSessionIdFromCookies">getSessionIdFromCookies</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.getUserFromCookies">getUserFromCookies</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.isUserAuthenticated">isUserAuthenticated</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#.logoutUser">logoutUser</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#~deleteCookie">deleteCookie</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#~generate256BitKey">generate256BitKey</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#~getAuthHeaders">getAuthHeaders</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#~getCookie">getCookie</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#~insertSessionData">insertSessionData</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#~saveUserToCookies">saveUserToCookies</a></li><li data-type='method'><a href="module-src_views_authentication_auth_encryption.html#~setCookie">setCookie</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#CommentsHistory">CommentsHistory</a></li><li><a href="global.html#DateInput">DateInput</a></li><li><a href="global.html#DatePicker">DatePicker</a></li><li><a href="global.html#DateRangePicker">DateRangePicker</a></li><li><a href="global.html#DocumentUpload">DocumentUpload</a></li><li><a href="global.html#DropZone">DropZone</a></li><li><a href="global.html#FileUpload">FileUpload</a></li><li><a href="global.html#ImageUpload">ImageUpload</a></li><li><a href="global.html#InlineDateRangePicker">InlineDateRangePicker</a></li><li><a href="global.html#Login2">Login2</a></li><li><a href="global.html#MultiFileUpload">MultiFileUpload</a></li><li><a href="global.html#TaskCard">TaskCard</a></li><li><a href="global.html#TaskSummaryPage">TaskSummaryPage</a></li><li><a href="global.html#base64ToArrayBuffer">base64ToArrayBuffer</a></li><li><a href="global.html#decrypt">decrypt</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">views/authentication/auth/AuthLogin.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// // /**
// //  * @fileoverview Task Inbox component for displaying and managing tasks
// //  * @module src/views/authentication/auth/AuthLogin
// //  * @author Rakshana
// //  * @date 22/07/2025
// //  * @since 1.0.0
// //  */

// // import React, { useState, useEffect } from 'react';
// // import {
// //   Box,
// //   TextField,
// //   Button,
// //   InputAdornment,
// //   IconButton,
// //   Alert,
// //   CircularProgress,
// //   Typography,
// //   Dialog,
// //   DialogTitle,
// //   DialogContent,
// //   DialogActions,
// //   Chip
// // } from '@mui/material';
// // import { Visibility, VisibilityOff, Person, Lock, Shield, DevicesOther } from '@mui/icons-material';
// // import { authenticateUser } from 'src/components/Encryption/Encryption';
// // import Cookies from 'js-cookie';
// // import OtpVerification from './OTPVerification';
// // import { HostName } from "src/assets/host/Host";

// // const AuthLogin = ({ subtitle, onLoginSuccess }) => {
// //   const [formData, setFormData] = useState({ username: '', password: '' });
// //   const [mobileNo, setMobileNo] = useState('');
// //   const [sessionId, setSessionId] = useState('');
// //   const [showPassword, setShowPassword] = useState(false);
// //   const [loading, setLoading] = useState(false);
// //   const [error, setError] = useState('');
// //   const [success, setSuccess] = useState(false);
// //   const [otpPhase, setOtpPhase] = useState(false);
// //   const [verifiedUser, setVerifiedUser] = useState(null);
// //   const [generatedOtp, setGeneratedOtp] = useState('');
// //   const [otpLoading, setOtpLoading] = useState(false);
// //   const [isTrustedDevice, setIsTrustedDevice] = useState(false);
// //   const [showTrustDialog, setShowTrustDialog] = useState(false);
// //   const [trustedDevices, setTrustedDevices] = useState([]);
// //   const TRUST_DURATION_DAYS = 30;
// //   const API_TOKEN = 'HRFGVJISOVp1fncC';

// //   const generateDeviceFingerprint = () => {
// //     const canvas = document.createElement('canvas');
// //     const ctx = canvas.getContext('2d');
// //     ctx.textBaseline = 'top';
// //     ctx.font = '14px Arial';
// //     ctx.fillText('Device fingerprint', 2, 2);

// //     const fingerprint = [
// //       navigator.userAgent,
// //       navigator.language,
// //       screen.width + 'x' + screen.height,
// //       new Date().getTimezoneOffset(),
// //       canvas.toDataURL(),
// //       navigator.hardwareConcurrency || 'unknown',
// //       navigator.deviceMemory || 'unknown'
// //     ].join('|');
// //     let hash = 0;
// //     for (let i = 0; i &lt; fingerprint.length; i++) {
// //       const char = fingerprint.charCodeAt(i);
// //       hash = ((hash &lt;&lt; 5) - hash) + char;
// //       hash = hash &amp; hash;
// //     }
// //     return Math.abs(hash).toString(16);
// //   };

// //   const getDeviceInfo = () => {
// //     const ua = navigator.userAgent;
// //     let deviceType = 'Unknown Device';
// //     let browser = 'Unknown Browser';
// //     if (/Mobile|Android|iPhone|iPad/.test(ua)) {
// //       if (/iPhone/.test(ua)) deviceType = 'iPhone';
// //       else if (/iPad/.test(ua)) deviceType = 'iPad';
// //       else if (/Android/.test(ua)) deviceType = 'Android Device';
// //       else deviceType = 'Mobile Device';
// //     } else {
// //       deviceType = 'Desktop';
// //     }
// //     if (/Chrome/.test(ua)) browser = 'Chrome';
// //     else if (/Firefox/.test(ua)) browser = 'Firefox';
// //     else if (/Safari/.test(ua)) browser = 'Safari';
// //     else if (/Edge/.test(ua)) browser = 'Edge';

// //     return `${deviceType} - ${browser}`;
// //   };

// //   const checkTrustedDevice = (username) => {
// //     const deviceFingerprint = generateDeviceFingerprint();
// //     const trustedDevicesData = localStorage.getItem(`trusted_devices_${username}`);

// //     if (trustedDevicesData) {
// //       const devices = JSON.parse(trustedDevicesData);
// //       const currentTime = new Date().getTime();
// //       const validDevices = devices.filter(device =>
// //         currentTime &lt; device.expiresAt
// //       );
// //       localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(validDevices));
// //       setTrustedDevices(validDevices);
// //       const trustedDevice = validDevices.find(device =>
// //         device.fingerprint === deviceFingerprint
// //       );

// //       return !!trustedDevice;
// //     }

// //     return false;
// //   };

// //   const addTrustedDevice = (username) => {
// //     const deviceFingerprint = generateDeviceFingerprint();
// //     const deviceInfo = getDeviceInfo();
// //     const currentTime = new Date().getTime();
// //     const expiresAt = currentTime + (TRUST_DURATION_DAYS * 24 * 60 * 60 * 1000);

// //     const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
// //     const filteredDevices = existingDevices.filter(device =>
// //       device.fingerprint !== deviceFingerprint
// //     );

// //     const newDevice = {
// //       fingerprint: deviceFingerprint,
// //       deviceInfo,
// //       trustedAt: currentTime,
// //       expiresAt,
// //       location: 'Current Location'
// //     };

// //     const updatedDevices = [...filteredDevices, newDevice];
// //     localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
// //     setTrustedDevices(updatedDevices);
// //   };

// //   const removeTrustedDevice = (username, fingerprint) => {
// //     const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
// //     const updatedDevices = existingDevices.filter(device =>
// //       device.fingerprint !== fingerprint
// //     );
// //     localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
// //     setTrustedDevices(updatedDevices);
// //   };

// //   const generateOtp = () => {
// //     return Math.floor(100000 + Math.random() * 900000).toString();
// //   };

// //   const sendOtpSms = async (otpCode, mobileNumber, sessionId) => {
// //     try {
// //       setOtpLoading(true);

// //       if (!mobileNumber || !/^\d{10,}$/.test(mobileNumber.replace(/\D/g, ''))) {
// //         throw new Error('Invalid or missing mobile number');
// //       }

// //       if (!sessionId) {
// //         throw new Error('Session ID not provided for OTP request. Please try logging in again.');
// //       }

// //       const message = encodeURIComponent(`The OTP to verify your mobile number on HMIS-Institute hospital is ${otpCode}-IITMWF`);
// //       const apiUrl = `https://enterprise.smsgupshup.com/GatewayAPI/rest?v=1.1&amp;method=SendMessage&amp;msg_type=TEXT&amp;userid=2000230894&amp;auth_scheme=plain&amp;password=z6eucW@q%20&amp;format=text&amp;msg=${message}&amp;send_to=${mobileNumber}`;

// //       try {
// //         await fetch(apiUrl, {
// //           method: 'GET',
// //           mode: 'no-cors'
// //         });
// //       } catch (corsError) {
// //       }

// //       const requestBody = {
// //         token: API_TOKEN,
// //         username: formData.username,
// //         mobileno: parseInt(mobileNumber.replace(/\D/g, '')),
// //         session_id: sessionId,
// //         otp: parseInt(otpCode),
// //         otpsendon: new Date().toISOString(),
// //         otpverifiedon: null,
// //         status: 0,
// //         updatedon: new Date().toISOString()
// //       };

// //       const headers = {
// //         'Content-Type': 'application/json',
// //         'Authorization': `Bearer ${Cookies.get('HRToken')}`,
// //       };

// //       const response = await fetch(`${HostName}/Loginotp`, {
// //         method: 'POST',
// //         headers: headers,
// //         body: JSON.stringify(requestBody)
// //       });

// //       if (!response.ok) {
// //         throw new Error(`HTTP error! status: ${response.status}`);
// //       }

// //       const encryptedData = await response.json();
// //       if (!encryptedData.Data) {
// //         throw new Error('No encrypted data received from API');
// //       }

// //       const decryptedData = await decryptData(encryptedData.Data);
// //       const result = validateJsonData(decryptedData);

// //       if (result.message !== 'OTP record inserted successfully') {
// //         throw new Error('Failed to insert OTP record');
// //       }

// //       return true;
// //     } catch (error) {
// //       if (error.message.includes('CORS') || error.message.includes('NetworkError')) {
// //         return true; // Treat as success for no-cors SMS API
// //       }
// //       throw new Error(error.message || 'Failed to send OTP SMS or call Loginotp API');
// //     } finally {
// //       setOtpLoading(false);
// //     }
// //   };

// //   const handleChange = (e) => {
// //     const { name, value } = e.target;
// //     setFormData(prev => ({ ...prev, [name]: value }));
// //     if (error) setError('');
// //   };

// //   const handleSubmit = async (e) => {
// //     e.preventDefault();

// //     if (!formData.username || !formData.password) {
// //       setError('Please enter both username and password');
// //       return;
// //     }

// //     setLoading(true);
// //     setError('');

// //     try {
// //       const result = await authenticateUser(formData.username, formData.password);

// //       if (result.success) {
// //         if (!result.user.mobileNo) {
// //           setError('Mobile number not found for this user. Please contact support.');
// //           setLoading(false);
// //           return;
// //         }

// //         setMobileNo(result.user.mobileNo);
// //         setSessionId(result.sessionId || result.user.userId);
// //         const isDeviceTrusted = checkTrustedDevice(formData.username);
// //         setIsTrustedDevice(isDeviceTrusted);

// //         if (isDeviceTrusted) {
// //           setSuccess(true);
// //           setVerifiedUser(result.user);
// //           sessionStorage.setItem('userInfo', JSON.stringify(result.user));
// //           Cookies.set('username', result.user.username, { expires: 1 });
// //           Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });

// //           if (onLoginSuccess) onLoginSuccess(result.user);
// //           setTimeout(() => {
// //             window.location.href = '/dashboard';
// //           }, 2000);
// //         } else {
// //           const otpCode = generateOtp();
// //           setGeneratedOtp(otpCode);

// //           if (!result.sessionId) {
// //             setError('Session ID not found in HRldap response. Using user ID as fallback.');
// //           }

// //           try {
// //             await sendOtpSms(otpCode, result.user.mobileNo, result.sessionId || result.user.userId);
// //             setOtpPhase(true);
// //             setVerifiedUser(result.user);
// //             sessionStorage.setItem('userInfo', JSON.stringify(result.user));
// //             Cookies.set('username', result.user.username, { expires: 1 });
// //             Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
// //           } catch (smsError) {
// //             setError(smsError.message || 'Failed to send OTP. Please try again.');
// //             setOtpPhase(true);
// //             setVerifiedUser(result.user);
// //             sessionStorage.setItem('userInfo', JSON.stringify(result.user));
// //             Cookies.set('username', result.user.username, { expires: 1 });
// //             Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
// //           }
// //         }
// //       } else {
// //         setError('Invalid credentials. Please try again.');
// //       }
// //     } catch (error) {
// //       setError(error.message || 'Login failed. Please try again.');
// //     } finally {
// //       setLoading(false);
// //     }
// //   };

// //   const handleOtpSuccess = (data) => {
// //     const { user, trustDevice } = data;

// //     if (trustDevice) {
// //       addTrustedDevice(formData.username);
// //     }

// //     setSuccess(true);
// //     if (onLoginSuccess) onLoginSuccess(user);
// //     setTimeout(() => {
// //       window.location.href = '/dashboard';
// //     }, 2000);
// //   };

// //   const handleOtpResend = async () => {
// //     setError('');
// //     setSuccess(false);

// //     try {
// //       const newOtp = generateOtp();
// //       setGeneratedOtp(newOtp);
// //       await sendOtpSms(newOtp, mobileNo, sessionId);
// //       setSuccess(true);
// //       setTimeout(() => setSuccess(false), 3000);
// //     } catch (error) {
// //       setError(error.message || 'Failed to resend OTP. Please try again.');
// //     }
// //   };

// //   const handleClickShowPassword = () => setShowPassword(!showPassword);

// //   useEffect(() => {
// //     if (formData.username) {
// //       const devices = JSON.parse(localStorage.getItem(`trusted_devices_${formData.username}`) || '[]');
// //       setTrustedDevices(devices);
// //     }
// //   }, [formData.username]);

// //   const formatDate = (timestamp) => {
// //     return new Date(timestamp).toLocaleDateString('en-US', {
// //       year: 'numeric',
// //       month: 'short',
// //       day: 'numeric'
// //     });
// //   };

// //   return (
// //     &lt;Box sx={{ width: '100%' }}>
// //       {!otpPhase &amp;&amp; (
// //         &lt;Box component="form" onSubmit={handleSubmit}>
// //           {error &amp;&amp; (
// //             &lt;Alert severity="error" sx={{ mb: 3, borderRadius: 2 }}>
// //               {error}
// //             &lt;/Alert>
// //           )}

// //           {success &amp;&amp; (
// //             &lt;Alert severity="success" sx={{ mb: 3, borderRadius: 2 }}>
// //               {isTrustedDevice ? 'Welcome back! Trusted device verified.' : 'Login successful!'}
// //             &lt;/Alert>
// //           )}

// //           &lt;Box sx={{ mb: 3 }}>
// //             &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Username&lt;/Typography>
// //             &lt;TextField
// //               fullWidth
// //               name="username"
// //               value={formData.username}
// //               onChange={handleChange}
// //               placeholder="Enter your username"
// //               disabled={loading}
// //               InputProps={{
// //                 startAdornment: (
// //                   &lt;InputAdornment position="start">
// //                     &lt;Person sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
// //                   &lt;/InputAdornment>
// //                 ),
// //               }}
// //               sx={{
// //                 '&amp; .MuiOutlinedInput-root': {
// //                   borderRadius: 2
// //                 }
// //               }}
// //             />
// //           &lt;/Box>

// //           &lt;Box sx={{ mb: 4 }}>
// //             &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Password&lt;/Typography>
// //             &lt;TextField
// //               fullWidth
// //               name="password"
// //               type={showPassword ? 'text' : 'password'}
// //               value={formData.password}
// //               onChange={handleChange}
// //               placeholder="Enter your password"
// //               disabled={loading}
// //               InputProps={{
// //                 startAdornment: (
// //                   &lt;InputAdornment position="start">
// //                     &lt;Lock sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
// //                   &lt;/InputAdornment>
// //                 ),
// //                 endAdornment: (
// //                   &lt;InputAdornment position="end">
// //                     &lt;IconButton onClick={handleClickShowPassword} edge="end" disabled={loading}>
// //                       {showPassword ? &lt;VisibilityOff /> : &lt;Visibility />}
// //                     &lt;/IconButton>
// //                   &lt;/InputAdornment>
// //                 ),
// //               }}
// //               sx={{
// //                 '&amp; .MuiOutlinedInput-root': {
// //                   borderRadius: 2
// //                 }
// //               }}
// //             />
// //           &lt;/Box>

// //           {formData.username &amp;&amp; trustedDevices.length > 0 &amp;&amp; (
// //             &lt;Box sx={{ mb: 3 }}>
// //               &lt;Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
// //                 &lt;Shield sx={{ color: '#10b981', mr: 1, fontSize: '1rem' }} />
// //                 &lt;Typography variant="body2" sx={{ color: '#10b981', fontWeight: 500 }}>
// //                   Trusted Devices ({trustedDevices.length})
// //                 &lt;/Typography>
// //                 &lt;Button
// //                   size="small"
// //                   onClick={() => setShowTrustDialog(true)}
// //                   sx={{ ml: 'auto', textTransform: 'none', fontSize: '0.75rem' }}
// //                 >
// //                   Manage
// //                 &lt;/Button>
// //               &lt;/Box>
// //               &lt;Typography variant="caption" sx={{ color: '#6b7280' }}>
// //                 Skip verification on trusted devices for {TRUST_DURATION_DAYS} days
// //               &lt;/Typography>
// //             &lt;/Box>
// //           )}

// //           &lt;Button
// //             type="submit"
// //             fullWidth
// //             disabled={loading || !formData.username || !formData.password}
// //             sx={{
// //               py: 1.5,
// //               borderRadius: 2,
// //               background: loading ? '#9ca3af' : 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',
// //               color: 'white',
// //               fontWeight: 600,
// //               fontSize: '0.875rem',
// //               textTransform: 'none',
// //             }}
// //           >
// //             {loading || otpLoading ? (
// //               &lt;Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
// //                 &lt;CircularProgress size={20} sx={{ color: 'white' }} />
// //                 &lt;span>{loading ? 'Signing In...' : 'Sending OTP...'}&lt;/span>
// //               &lt;/Box>
// //             ) : (
// //               &lt;span style={{ color: 'white' }}>Sign In&lt;/span>
// //             )}
// //           &lt;/Button>

// //           {subtitle &amp;&amp; &lt;Box sx={{ mt: 3, textAlign: 'center' }}>{subtitle}&lt;/Box>}
// //         &lt;/Box>
// //       )}

// //       {otpPhase &amp;&amp; (
// //         &lt;OtpVerification
// //           verifiedUser={verifiedUser}
// //           onOtpSuccess={handleOtpSuccess}
// //           onResendOtp={handleOtpResend}
// //           phoneNumber={mobileNo}
// //           generatedOtp={generatedOtp}
// //           otpLoading={otpLoading}
// //           trustDurationDays={TRUST_DURATION_DAYS}
// //           sessionId={sessionId}
// //         />
// //       )}

// //       &lt;Dialog
// //         open={showTrustDialog}
// //         onClose={() => setShowTrustDialog(false)}
// //         maxWidth="sm"
// //         fullWidth
// //       >
// //         &lt;DialogTitle>
// //           &lt;Box sx={{ display: 'flex', alignItems: 'center' }}>
// //             &lt;DevicesOther sx={{ mr: 1 }} />
// //             Trusted Devices
// //           &lt;/Box>
// //         &lt;/DialogTitle>
// //         &lt;DialogContent>
// //           {trustedDevices.length === 0 ? (
// //             &lt;Typography color="textSecondary">
// //               No trusted devices found.
// //             &lt;/Typography>
// //           ) : (
// //             &lt;Box>
// //               &lt;Typography variant="body2" sx={{ mb: 2, color: '#6b7280' }}>
// //                 These devices can skip OTP verification until they expire.
// //               &lt;/Typography>
// //               {trustedDevices.map((device, index) => (
// //                 &lt;Box
// //                   key={device.fingerprint}
// //                   sx={{
// //                     p: 2,
// //                     border: '1px solid #e5e7eb',
// //                     borderRadius: 2,
// //                     mb: 2
// //                   }}
// //                 >
// //                   &lt;Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
// //                     &lt;Box sx={{ flex: 1 }}>
// //                       &lt;Typography variant="subtitle2" sx={{ fontWeight: 600 }}>
// //                         {device.deviceInfo}
// //                       &lt;/Typography>
// //                       &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
// //                         Trusted on {formatDate(device.trustedAt)}
// //                       &lt;/Typography>
// //                       &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
// //                         Expires on {formatDate(device.expiresAt)}
// //                       &lt;/Typography>
// //                       {device.fingerprint === generateDeviceFingerprint() &amp;&amp; (
// //                         &lt;Chip
// //                           label="Current Device"
// //                           size="small"
// //                           color="primary"
// //                           sx={{ mt: 1 }}
// //                         />
// //                       )}
// //                     &lt;/Box>
// //                     &lt;Button
// //                       size="small"
// //                       color="error"
// //                       onClick={() => removeTrustedDevice(formData.username, device.fingerprint)}
// //                       sx={{ textTransform: 'none' }}
// //                     >
// //                       Remove
// //                     &lt;/Button>
// //                   &lt;/Box>
// //                 &lt;/Box>
// //               ))}
// //             &lt;/Box>
// //           )}
// //         &lt;/DialogContent>
// //         &lt;DialogActions>
// //           &lt;Button onClick={() => setShowTrustDialog(false)}>
// //             Close
// //           &lt;/Button>
// //         &lt;/DialogActions>
// //       &lt;/Dialog>
// //     &lt;/Box>
// //   );
// // };

// // export default AuthLogin;







// // /**
// //  * @fileoverview Task Inbox component for displaying and managing tasks
// //  * @module src/views/authentication/auth/AuthLogin
// //  * @author Rakshana
// //  * @date 22/07/2025
// //  * @since 1.0.0
// //  */

// // import React, { useState, useEffect } from 'react';
// // import {
// //   Box,
// //   TextField,
// //   Button,
// //   InputAdornment,
// //   IconButton,
// //   Alert,
// //   CircularProgress,
// //   Typography,
// //   Dialog,
// //   DialogTitle,
// //   DialogContent,
// //   DialogActions,
// //   Chip
// // } from '@mui/material';
// // import { Visibility, VisibilityOff, Person, Lock, Shield, DevicesOther } from '@mui/icons-material';
// // import { authenticateUser } from 'src/components/Encryption/Encryption';
// // import Cookies from 'js-cookie';
// // import OtpVerification from './OTPVerification';
// // import { HostName } from "src/assets/host/Host";

// // const AuthLogin = ({ subtitle, onLoginSuccess }) => {
// //   const [formData, setFormData] = useState({ username: '', password: '' });
// //   const [mobileNo, setMobileNo] = useState('');
// //   const [sessionId, setSessionId] = useState('');
// //   const [showPassword, setShowPassword] = useState(false);
// //   const [loading, setLoading] = useState(false);
// //   const [error, setError] = useState('');
// //   const [success, setSuccess] = useState(false);
// //   const [otpPhase, setOtpPhase] = useState(false);
// //   const [verifiedUser, setVerifiedUser] = useState(null);
// //   const [generatedOtp, setGeneratedOtp] = useState('');
// //   const [otpLoading, setOtpLoading] = useState(false);
// //   const [isTrustedDevice, setIsTrustedDevice] = useState(false);
// //   const [showTrustDialog, setShowTrustDialog] = useState(false);
// //   const [trustedDevices, setTrustedDevices] = useState([]);
// //   const TRUST_DURATION_DAYS = 30;
// //   const API_TOKEN = 'HRFGVJISOVp1fncC';

// //   const generateDeviceFingerprint = () => {
// //     const canvas = document.createElement('canvas');
// //     const ctx = canvas.getContext('2d');
// //     ctx.textBaseline = 'top';
// //     ctx.font = '14px Arial';
// //     ctx.fillText('Device fingerprint', 2, 2);

// //     const fingerprint = [
// //       navigator.userAgent,
// //       navigator.language,
// //       screen.width + 'x' + screen.height,
// //       new Date().getTimezoneOffset(),
// //       canvas.toDataURL(),
// //       navigator.hardwareConcurrency || 'unknown',
// //       navigator.deviceMemory || 'unknown'
// //     ].join('|');
// //     let hash = 0;
// //     for (let i = 0; i &lt; fingerprint.length; i++) {
// //       const char = fingerprint.charCodeAt(i);
// //       hash = ((hash &lt;&lt; 5) - hash) + char;
// //       hash = hash &amp; hash;
// //     }
// //     return Math.abs(hash).toString(16);
// //   };

// //   const getDeviceInfo = () => {
// //     const ua = navigator.userAgent;
// //     let deviceType = 'Unknown Device';
// //     let browser = 'Unknown Browser';
    
// //     if (/Mobile|Android|iPhone|iPad/.test(ua)) {
// //       if (/iPhone/.test(ua)) deviceType = 'iPhone';
// //       else if (/iPad/.test(ua)) deviceType = 'iPad';
// //       else if (/Android/.test(ua)) deviceType = 'Android Device';
// //       else deviceType = 'Mobile Device';
// //     } else {
// //       deviceType = 'Desktop';
// //     }
    
// //     if (/Chrome/.test(ua)) browser = 'Chrome';
// //     else if (/Firefox/.test(ua)) browser = 'Firefox';
// //     else if (/Safari/.test(ua)) browser = 'Safari';
// //     else if (/Edge/.test(ua)) browser = 'Edge';

// //     return `${deviceType} - ${browser}`;
// //   };

// //   // Helper function to safely get device info string
// //   const getDeviceInfoString = (deviceInfo) => {
// //     if (typeof deviceInfo === 'string') {
// //       return deviceInfo;
// //     } else if (typeof deviceInfo === 'object' &amp;&amp; deviceInfo !== null) {
// //       // Handle case where deviceInfo is an object
// //       const { browser = 'Unknown Browser', os = 'Unknown OS', screen = '', language = '' } = deviceInfo;
// //       return `${os} - ${browser}`;
// //     } else {
// //       return 'Unknown Device';
// //     }
// //   };

// //   const checkTrustedDevice = (username) => {
// //     const deviceFingerprint = generateDeviceFingerprint();
// //     const trustedDevicesData = localStorage.getItem(`trusted_devices_${username}`);

// //     if (trustedDevicesData) {
// //       try {
// //         const devices = JSON.parse(trustedDevicesData);
// //         const currentTime = new Date().getTime();
// //         const validDevices = devices.filter(device =>
// //           currentTime &lt; device.expiresAt
// //         );
// //         localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(validDevices));
// //         setTrustedDevices(validDevices);
// //         const trustedDevice = validDevices.find(device =>
// //           device.fingerprint === deviceFingerprint
// //         );

// //         return !!trustedDevice;
// //       } catch (error) {
// //         console.error('Error parsing trusted devices data:', error);
// //         localStorage.removeItem(`trusted_devices_${username}`);
// //         return false;
// //       }
// //     }

// //     return false;
// //   };

// //   const addTrustedDevice = (username) => {
// //     const deviceFingerprint = generateDeviceFingerprint();
// //     const deviceInfo = getDeviceInfo(); // This returns a string
// //     const currentTime = new Date().getTime();
// //     const expiresAt = currentTime + (TRUST_DURATION_DAYS * 24 * 60 * 60 * 1000);

// //     try {
// //       const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
// //       const filteredDevices = existingDevices.filter(device =>
// //         device.fingerprint !== deviceFingerprint
// //       );

// //       const newDevice = {
// //         fingerprint: deviceFingerprint,
// //         deviceInfo, // This should be a string
// //         trustedAt: currentTime,
// //         expiresAt,
// //         location: 'Current Location'
// //       };

// //       const updatedDevices = [...filteredDevices, newDevice];
// //       localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
// //       setTrustedDevices(updatedDevices);
// //     } catch (error) {
// //       console.error('Error adding trusted device:', error);
// //     }
// //   };

// //   const removeTrustedDevice = (username, fingerprint) => {
// //     try {
// //       const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
// //       const updatedDevices = existingDevices.filter(device =>
// //         device.fingerprint !== fingerprint
// //       );
// //       localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
// //       setTrustedDevices(updatedDevices);
// //     } catch (error) {
// //       console.error('Error removing trusted device:', error);
// //     }
// //   };

// //   const generateOtp = () => {
// //     return Math.floor(100000 + Math.random() * 900000).toString();
// //   };

// //   const sendOtpSms = async (otpCode, mobileNumber, sessionId) => {
// //     try {
// //       setOtpLoading(true);

// //       if (!mobileNumber || !/^\d{10,}$/.test(mobileNumber.replace(/\D/g, ''))) {
// //         throw new Error('Invalid or missing mobile number');
// //       }

// //       if (!sessionId) {
// //         throw new Error('Session ID not provided for OTP request. Please try logging in again.');
// //       }

// //       const message = encodeURIComponent(`The OTP to verify your mobile number on HMIS-Institute hospital is ${otpCode}-IITMWF`);
// //       const apiUrl = `https://enterprise.smsgupshup.com/GatewayAPI/rest?v=1.1&amp;method=SendMessage&amp;msg_type=TEXT&amp;userid=2000230894&amp;auth_scheme=plain&amp;password=z6eucW@q%20&amp;format=text&amp;msg=${message}&amp;send_to=${mobileNumber}`;

// //       try {
// //         await fetch(apiUrl, {
// //           method: 'GET',
// //           mode: 'no-cors'
// //         });
// //       } catch (corsError) {
// //         // Handle CORS error silently
// //       }

// //       const requestBody = {
// //         token: API_TOKEN,
// //         username: formData.username,
// //         mobileno: parseInt(mobileNumber.replace(/\D/g, '')),
// //         session_id: sessionId,
// //         otp: parseInt(otpCode),
// //         otpsendon: new Date().toISOString(),
// //         otpverifiedon: null,
// //         status: 0,
// //         updatedon: new Date().toISOString()
// //       };

// //       const headers = {
// //         'Content-Type': 'application/json',
// //         'Authorization': `Bearer ${Cookies.get('HRToken')}`,
// //       };

// //       const response = await fetch(`${HostName}/Loginotp`, {
// //         method: 'POST',
// //         headers: headers,
// //         body: JSON.stringify(requestBody)
// //       });

// //       if (!response.ok) {
// //         throw new Error(`HTTP error! status: ${response.status}`);
// //       }

// //       const encryptedData = await response.json();
// //       if (!encryptedData.Data) {
// //         throw new Error('No encrypted data received from API');
// //       }

// //       const decryptedData = await decryptData(encryptedData.Data);
// //       const result = validateJsonData(decryptedData);

// //       if (result.message !== 'OTP record inserted successfully') {
// //         throw new Error('Failed to insert OTP record');
// //       }

// //       return true;
// //     } catch (error) {
// //       if (error.message.includes('CORS') || error.message.includes('NetworkError')) {
// //         return true; // Treat as success for no-cors SMS API
// //       }
// //       throw new Error(error.message || 'Failed to send OTP SMS or call Loginotp API');
// //     } finally {
// //       setOtpLoading(false);
// //     }
// //   };

// //   const handleChange = (e) => {
// //     const { name, value } = e.target;
// //     setFormData(prev => ({ ...prev, [name]: value }));
// //     if (error) setError('');
// //   };

// //   const handleSubmit = async (e) => {
// //     e.preventDefault();

// //     if (!formData.username || !formData.password) {
// //       setError('Please enter both username and password');
// //       return;
// //     }

// //     setLoading(true);
// //     setError('');

// //     try {
// //       const result = await authenticateUser(formData.username, formData.password);

// //       if (result.success) {
// //         if (!result.user.mobileNo) {
// //           setError('Mobile number not found for this user. Please contact support.');
// //           setLoading(false);
// //           return;
// //         }

// //         setMobileNo(result.user.mobileNo);
// //         setSessionId(result.sessionId || result.user.userId);
// //         const isDeviceTrusted = checkTrustedDevice(formData.username);
// //         setIsTrustedDevice(isDeviceTrusted);

// //         if (isDeviceTrusted) {
// //           setSuccess(true);
// //           setVerifiedUser(result.user);
// //           sessionStorage.setItem('userInfo', JSON.stringify(result.user));
// //           Cookies.set('username', result.user.username, { expires: 1 });
// //           Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });

// //           if (onLoginSuccess) onLoginSuccess(result.user);
// //           setTimeout(() => {
// //             window.location.href = '/dashboard';
// //           }, 2000);
// //         } else {
// //           const otpCode = generateOtp();
// //           setGeneratedOtp(otpCode);

// //           if (!result.sessionId) {
// //             setError('Session ID not found in HRldap response. Using user ID as fallback.');
// //           }

// //           try {
// //             await sendOtpSms(otpCode, result.user.mobileNo, result.sessionId || result.user.userId);
// //             setOtpPhase(true);
// //             setVerifiedUser(result.user);
// //             sessionStorage.setItem('userInfo', JSON.stringify(result.user));
// //             Cookies.set('username', result.user.username, { expires: 1 });
// //             Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
// //           } catch (smsError) {
// //             setError(smsError.message || 'Failed to send OTP. Please try again.');
// //             setOtpPhase(true);
// //             setVerifiedUser(result.user);
// //             sessionStorage.setItem('userInfo', JSON.stringify(result.user));
// //             Cookies.set('username', result.user.username, { expires: 1 });
// //             Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
// //           }
// //         }
// //       } else {
// //         setError('Invalid credentials. Please try again.');
// //       }
// //     } catch (error) {
// //       setError(error.message || 'Login failed. Please try again.');
// //     } finally {
// //       setLoading(false);
// //     }
// //   };

// //   const handleOtpSuccess = (data) => {
// //     const { user, trustDevice } = data;

// //     if (trustDevice) {
// //       addTrustedDevice(formData.username);
// //     }

// //     setSuccess(true);
// //     if (onLoginSuccess) onLoginSuccess(user);
// //     setTimeout(() => {
// //       window.location.href = '/dashboard';
// //     }, 2000);
// //   };

// //   const handleOtpResend = async () => {
// //     setError('');
// //     setSuccess(false);

// //     try {
// //       const newOtp = generateOtp();
// //       setGeneratedOtp(newOtp);
// //       await sendOtpSms(newOtp, mobileNo, sessionId);
// //       setSuccess(true);
// //       setTimeout(() => setSuccess(false), 3000);
// //     } catch (error) {
// //       setError(error.message || 'Failed to resend OTP. Please try again.');
// //     }
// //   };

// //   const handleClickShowPassword = () => setShowPassword(!showPassword);

// //   useEffect(() => {
// //     if (formData.username) {
// //       try {
// //         const devices = JSON.parse(localStorage.getItem(`trusted_devices_${formData.username}`) || '[]');
// //         setTrustedDevices(devices);
// //       } catch (error) {
// //         console.error('Error loading trusted devices:', error);
// //         setTrustedDevices([]);
// //       }
// //     }
// //   }, [formData.username]);

// //   const formatDate = (timestamp) => {
// //     return new Date(timestamp).toLocaleDateString('en-US', {
// //       year: 'numeric',
// //       month: 'short',
// //       day: 'numeric'
// //     });
// //   };

// //   return (
// //     &lt;Box sx={{ width: '100%' }}>
// //       {!otpPhase &amp;&amp; (
// //         &lt;Box component="form" onSubmit={handleSubmit}>
// //           {error &amp;&amp; (
// //             &lt;Alert severity="error" sx={{ mb: 3, borderRadius: 2 }}>
// //               {error}
// //             &lt;/Alert>
// //           )}

// //           {success &amp;&amp; (
// //             &lt;Alert severity="success" sx={{ mb: 3, borderRadius: 2 }}>
// //               {isTrustedDevice ? 'Welcome back! Trusted device verified.' : 'Login successful!'}
// //             &lt;/Alert>
// //           )}

// //           &lt;Box sx={{ mb: 3 }}>
// //             &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Username&lt;/Typography>
// //             &lt;TextField
// //               fullWidth
// //               name="username"
// //               value={formData.username}
// //               onChange={handleChange}
// //               placeholder="Enter your username"
// //               disabled={loading}
// //               InputProps={{
// //                 startAdornment: (
// //                   &lt;InputAdornment position="start">
// //                     &lt;Person sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
// //                   &lt;/InputAdornment>
// //                 ),
// //               }}
// //               sx={{
// //                 '&amp; .MuiOutlinedInput-root': {
// //                   borderRadius: 2
// //                 }
// //               }}
// //             />
// //           &lt;/Box>

// //           &lt;Box sx={{ mb: 4 }}>
// //             &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Password&lt;/Typography>
// //             &lt;TextField
// //               fullWidth
// //               name="password"
// //               type={showPassword ? 'text' : 'password'}
// //               value={formData.password}
// //               onChange={handleChange}
// //               placeholder="Enter your password"
// //               disabled={loading}
// //               InputProps={{
// //                 startAdornment: (
// //                   &lt;InputAdornment position="start">
// //                     &lt;Lock sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
// //                   &lt;/InputAdornment>
// //                 ),
// //                 endAdornment: (
// //                   &lt;InputAdornment position="end">
// //                     &lt;IconButton onClick={handleClickShowPassword} edge="end" disabled={loading}>
// //                       {showPassword ? &lt;VisibilityOff /> : &lt;Visibility />}
// //                     &lt;/IconButton>
// //                   &lt;/InputAdornment>
// //                 ),
// //               }}
// //               sx={{
// //                 '&amp; .MuiOutlinedInput-root': {
// //                   borderRadius: 2
// //                 }
// //               }}
// //             />
// //           &lt;/Box>

// //           {formData.username &amp;&amp; trustedDevices.length > 0 &amp;&amp; (
// //             &lt;Box sx={{ mb: 3 }}>
// //               &lt;Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
// //                 &lt;Shield sx={{ color: '#10b981', mr: 1, fontSize: '1rem' }} />
// //                 &lt;Typography variant="body2" sx={{ color: '#10b981', fontWeight: 500 }}>
// //                   Trusted Devices ({trustedDevices.length})
// //                 &lt;/Typography>
// //                 &lt;Button
// //                   size="small"
// //                   onClick={() => setShowTrustDialog(true)}
// //                   sx={{ ml: 'auto', textTransform: 'none', fontSize: '0.75rem' }}
// //                 >
// //                   Manage
// //                 &lt;/Button>
// //               &lt;/Box>
// //               &lt;Typography variant="caption" sx={{ color: '#6b7280' }}>
// //                 Skip verification on trusted devices for {TRUST_DURATION_DAYS} days
// //               &lt;/Typography>
// //             &lt;/Box>
// //           )}

// //           &lt;Button
// //             type="submit"
// //             fullWidth
// //             disabled={loading || !formData.username || !formData.password}
// //             sx={{
// //               py: 1.5,
// //               borderRadius: 2,
// //               background: loading ? '#9ca3af' : 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',
// //               color: 'white',
// //               fontWeight: 600,
// //               fontSize: '0.875rem',
// //               textTransform: 'none',
// //             }}
// //           >
// //             {loading || otpLoading ? (
// //               &lt;Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
// //                 &lt;CircularProgress size={20} sx={{ color: 'white' }} />
// //                 &lt;span>{loading ? 'Signing In...' : 'Sending OTP...'}&lt;/span>
// //               &lt;/Box>
// //             ) : (
// //               &lt;span style={{ color: 'white' }}>Sign In&lt;/span>
// //             )}
// //           &lt;/Button>

// //           {subtitle &amp;&amp; &lt;Box sx={{ mt: 3, textAlign: 'center' }}>{subtitle}&lt;/Box>}
// //         &lt;/Box>
// //       )}

// //       {otpPhase &amp;&amp; (
// //         &lt;OtpVerification
// //           verifiedUser={verifiedUser}
// //           onOtpSuccess={handleOtpSuccess}
// //           onResendOtp={handleOtpResend}
// //           phoneNumber={mobileNo}
// //           generatedOtp={generatedOtp}
// //           otpLoading={otpLoading}
// //           trustDurationDays={TRUST_DURATION_DAYS}
// //           sessionId={sessionId}
// //         />
// //       )}

// //       &lt;Dialog
// //         open={showTrustDialog}
// //         onClose={() => setShowTrustDialog(false)}
// //         maxWidth="sm"
// //         fullWidth
// //       >
// //         &lt;DialogTitle>
// //           &lt;Box sx={{ display: 'flex', alignItems: 'center' }}>
// //             &lt;DevicesOther sx={{ mr: 1 }} />
// //             Trusted Devices
// //           &lt;/Box>
// //         &lt;/DialogTitle>
// //         &lt;DialogContent>
// //           {trustedDevices.length === 0 ? (
// //             &lt;Typography color="textSecondary">
// //               No trusted devices found.
// //             &lt;/Typography>
// //           ) : (
// //             &lt;Box>
// //               &lt;Typography variant="body2" sx={{ mb: 2, color: '#6b7280' }}>
// //                 These devices can skip OTP verification until they expire.
// //               &lt;/Typography>
// //               {trustedDevices.map((device, index) => (
// //                 &lt;Box
// //                   key={device.fingerprint}
// //                   sx={{
// //                     p: 2,
// //                     border: '1px solid #e5e7eb',
// //                     borderRadius: 2,
// //                     mb: 2
// //                   }}
// //                 >
// //                   &lt;Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
// //                     &lt;Box sx={{ flex: 1 }}>
// //                       &lt;Typography variant="subtitle2" sx={{ fontWeight: 600 }}>
// //                         {getDeviceInfoString(device.deviceInfo)}
// //                       &lt;/Typography>
// //                       &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
// //                         Trusted on {formatDate(device.trustedAt)}
// //                       &lt;/Typography>
// //                       &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
// //                         Expires on {formatDate(device.expiresAt)}
// //                       &lt;/Typography>
// //                       {device.fingerprint === generateDeviceFingerprint() &amp;&amp; (
// //                         &lt;Chip
// //                           label="Current Device"
// //                           size="small"
// //                           color="primary"
// //                           sx={{ mt: 1 }}
// //                         />
// //                       )}
// //                     &lt;/Box>
// //                     &lt;Button
// //                       size="small"
// //                       color="error"
// //                       onClick={() => removeTrustedDevice(formData.username, device.fingerprint)}
// //                       sx={{ textTransform: 'none' }}
// //                     >
// //                       Remove
// //                     &lt;/Button>
// //                   &lt;/Box>
// //                 &lt;/Box>
// //               ))}
// //             &lt;/Box>
// //           )}
// //         &lt;/DialogContent>
// //         &lt;DialogActions>
// //           &lt;Button onClick={() => setShowTrustDialog(false)}>
// //             Close
// //           &lt;/Button>
// //         &lt;/DialogActions>
// //       &lt;/Dialog>
// //     &lt;/Box>
// //   );
// // };

// // export default AuthLogin;



// /**
//  * @fileoverview Task Inbox component for displaying and managing tasks
//  * @module src/views/authentication/auth/AuthLogin
//  * @author Rakshana
//  * @date 22/07/2025
//  * @since 1.0.0
//  */

// import React, { useState, useEffect } from 'react';
// import {
//   Box,
//   TextField,
//   Button,
//   InputAdornment,
//   IconButton,
//   Alert,
//   CircularProgress,
//   Typography,
//   Dialog,
//   DialogTitle,
//   DialogContent,
//   DialogActions,
//   Chip
// } from '@mui/material';
// import { Visibility, VisibilityOff, Person, Lock, Shield, DevicesOther } from '@mui/icons-material';
// // Import encryptECB from the Encryption module
// import { authenticateUser, encryptECB } from 'src/components/Encryption/Encryption';
// import Cookies from 'js-cookie';
// import OtpVerification from './OTPVerification';
// import { HostName } from "src/assets/host/Host";

// const AuthLogin = ({ subtitle, onLoginSuccess }) => {
//   const [formData, setFormData] = useState({ username: '', password: '' });
//   const [mobileNo, setMobileNo] = useState('');
//   const [sessionId, setSessionId] = useState('');
//   const [showPassword, setShowPassword] = useState(false);
//   const [loading, setLoading] = useState(false);
//   const [error, setError] = useState('');
//   const [success, setSuccess] = useState(false);
//   const [otpPhase, setOtpPhase] = useState(false);
//   const [verifiedUser, setVerifiedUser] = useState(null);
//   const [generatedOtp, setGeneratedOtp] = useState('');
//   const [otpLoading, setOtpLoading] = useState(false);
//   const [isTrustedDevice, setIsTrustedDevice] = useState(false);
//   const [showTrustDialog, setShowTrustDialog] = useState(false);
//   const [trustedDevices, setTrustedDevices] = useState([]);
//   const TRUST_DURATION_DAYS = 30;
//   const API_TOKEN = 'HRFGVJISOVp1fncC';
//   // Define the encryption key locally, as it's used here for mobile number encryption
//   const ENCRYPTION_KEY = '7xPz!qL3vNc#eRb9Wm@f2Zh8Kd$gYp1B';

//   const generateDeviceFingerprint = () => {
//     const canvas = document.createElement('canvas');
//     const ctx = canvas.getContext('2d');
//     ctx.textBaseline = 'top';
//     ctx.font = '14px Arial';
//     ctx.fillText('Device fingerprint', 2, 2);

//     const fingerprint = [
//       navigator.userAgent,
//       navigator.language,
//       screen.width + 'x' + screen.height,
//       new Date().getTimezoneOffset(),
//       canvas.toDataURL(),
//       navigator.hardwareConcurrency || 'unknown',
//       navigator.deviceMemory || 'unknown'
//     ].join('|');
//     let hash = 0;
//     for (let i = 0; i &lt; fingerprint.length; i++) {
//       const char = fingerprint.charCodeAt(i);
//       hash = ((hash &lt;&lt; 5) - hash) + char;
//       hash = hash &amp; hash;
//     }
//     return Math.abs(hash).toString(16);
//   };

//   const getDeviceInfo = () => {
//     const ua = navigator.userAgent;
//     let deviceType = 'Unknown Device';
//     let browser = 'Unknown Browser';

//     if (/Mobile|Android|iPhone|iPad/.test(ua)) {
//       if (/iPhone/.test(ua)) deviceType = 'iPhone';
//       else if (/iPad/.test(ua)) deviceType = 'iPad';
//       else if (/Android/.test(ua)) deviceType = 'Android Device';
//       else deviceType = 'Mobile Device';
//     } else {
//       deviceType = 'Desktop';
//     }

//     if (/Chrome/.test(ua)) browser = 'Chrome';
//     else if (/Firefox/.test(ua)) browser = 'Firefox';
//     else if (/Safari/.test(ua)) browser = 'Safari';
//     else if (/Edge/.test(ua)) browser = 'Edge';

//     return `${deviceType} - ${browser}`;
//   };

//   // Helper function to safely get device info string
//   const getDeviceInfoString = (deviceInfo) => {
//     if (typeof deviceInfo === 'string') {
//       return deviceInfo;
//     } else if (typeof deviceInfo === 'object' &amp;&amp; deviceInfo !== null) {
//       // Handle case where deviceInfo is an object
//       const { browser = 'Unknown Browser', os = 'Unknown OS', screen = '', language = '' } = deviceInfo;
//       return `${os} - ${browser}`;
//     } else {
//       return 'Unknown Device';
//     }
//   };

//   const checkTrustedDevice = (username) => {
//     const deviceFingerprint = generateDeviceFingerprint();
//     const trustedDevicesData = localStorage.getItem(`trusted_devices_${username}`);

//     if (trustedDevicesData) {
//       try {
//         const devices = JSON.parse(trustedDevicesData);
//         const currentTime = new Date().getTime();
//         const validDevices = devices.filter(device =>
//           currentTime &lt; device.expiresAt
//         );
//         localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(validDevices));
//         setTrustedDevices(validDevices);
//         const trustedDevice = validDevices.find(device =>
//           device.fingerprint === deviceFingerprint
//         );

//         return !!trustedDevice;
//       } catch (error) {
//         console.error('Error parsing trusted devices data:', error);
//         localStorage.removeItem(`trusted_devices_${username}`);
//         return false;
//       }
//     }

//     return false;
//   };

//   const addTrustedDevice = (username) => {
//     const deviceFingerprint = generateDeviceFingerprint();
//     const deviceInfo = getDeviceInfo(); // This returns a string
//     const currentTime = new Date().getTime();
//     const expiresAt = currentTime + (TRUST_DURATION_DAYS * 24 * 60 * 60 * 1000);

//     try {
//       const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
//       const filteredDevices = existingDevices.filter(device =>
//         device.fingerprint !== deviceFingerprint
//       );

//       const newDevice = {
//         fingerprint: deviceFingerprint,
//         deviceInfo, // This should be a string
//         trustedAt: currentTime,
//         expiresAt,
//         location: 'Current Location'
//       };

//       const updatedDevices = [...filteredDevices, newDevice];
//       localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
//       setTrustedDevices(updatedDevices);
//     } catch (error) {
//       console.error('Error adding trusted device:', error);
//     }
//   };

//   const removeTrustedDevice = (username, fingerprint) => {
//     try {
//       const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
//       const updatedDevices = existingDevices.filter(device =>
//         device.fingerprint !== fingerprint
//       );
//       localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
//       setTrustedDevices(updatedDevices);
//     } catch (error) {
//       console.error('Error removing trusted device:', error);
//     }
//   };

//   const generateOtp = () => {
//     return Math.floor(100000 + Math.random() * 900000).toString();
//   };

//   const sendOtpSms = async (otpCode, mobileNumber, sessionId) => {
//     try {
//       setOtpLoading(true);

//       if (!mobileNumber || !/^\d{10,}$/.test(mobileNumber.replace(/\D/g, ''))) {
//         throw new Error('Invalid or missing mobile number');
//       }

//       if (!sessionId) {
//         throw new Error('Session ID not provided for OTP request. Please try logging in again.');
//       }

//       // --- NEW OTP SENDING LOGIC ---
//       const encryptedMobileNo = encryptECB(mobileNumber.replace(/\D/g, ''), ENCRYPTION_KEY); // Encrypt the cleaned mobile number
//       const otpSendApiUrl = 'https://wftest1.iitm.ac.in:7000/SendOTP';
//       const otpSendRequestBody = {
//         token: API_TOKEN,
//         send_to: encryptedMobileNo,
//       };

//       const otpSendHeaders = {
//         'Content-Type': 'application/json',
//         'Authorization': `Bearer ${Cookies.get('HRToken')}`
//       };

//       const otpSendResponse = await fetch(otpSendApiUrl, {
//         method: 'POST',
//         headers: otpSendHeaders,
//         body: JSON.stringify(otpSendRequestBody)
//       });

//       if (!otpSendResponse.ok) {
//         const errorText = await otpSendResponse.text(); // Get raw text for better error info
//         throw new Error(`Failed to send OTP via new API: HTTP error! status: ${otpSendResponse.status} - ${errorText}`);
//       }
//       // --- END NEW OTP SENDING LOGIC ---

//       // This part remains, as it's for recording the OTP in the system,
//       // distinct from the SMS gateway used to send it.
//       const requestBody = {
//         token: API_TOKEN,
//         username: formData.username,
//         mobileno: parseInt(mobileNumber.replace(/\D/g, '')),
//         session_id: sessionId,
//         otp: parseInt(otpCode),
//         otpsendon: new Date().toISOString(),
//         otpverifiedon: null,
//         status: 0,
//         updatedon: new Date().toISOString()
//       };

//       const headers = {
//         'Content-Type': 'application/json',
//         'Authorization': `Bearer ${Cookies.get('HRToken')}`,
//       };

//       const response = await fetch(`${HostName}/Loginotp`, {
//         method: 'POST',
//         headers: headers,
//         body: JSON.stringify(requestBody)
//       });

//       if (!response.ok) {
//         throw new Error(`HTTP error! status: ${response.status}`);
//       }

//       const encryptedData = await response.json();
//       if (!encryptedData.Data) {
//         throw new Error('No encrypted data received from API');
//       }

//       // Assuming decryptData and validateJsonData are available globally or imported elsewhere.
//       const decryptedData = await decryptData(encryptedData.Data);
//       const result = validateJsonData(decryptedData);

//       if (result.message !== 'OTP record inserted successfully') {
//         throw new Error('Failed to insert OTP record');
//       }

//       return true;
//     } catch (error) {
//       throw new Error(error.message || 'Failed to send OTP or record OTP status.');
//     } finally {
//       setOtpLoading(false);
//     }
//   };

//   const handleChange = (e) => {
//     const { name, value } = e.target;
//     setFormData(prev => ({ ...prev, [name]: value }));
//     if (error) setError('');
//   };

//   const handleSubmit = async (e) => {
//     e.preventDefault();

//     if (!formData.username || !formData.password) {
//       setError('Please enter both username and password');
//       return;
//     }

//     setLoading(true);
//     setError('');

//     try {
//       const result = await authenticateUser(formData.username, formData.password);

//       if (result.success) {
//         if (!result.user.mobileNo) {
//           setError('Mobile number not found for this user. Please contact support.');
//           setLoading(false);
//           return;
//         }

//         setMobileNo(result.user.mobileNo);
//         setSessionId(result.sessionId || result.user.userId);
//         const isDeviceTrusted = checkTrustedDevice(formData.username);
//         setIsTrustedDevice(isDeviceTrusted);

//         if (isDeviceTrusted) {
//           setSuccess(true);
//           setVerifiedUser(result.user);
//           sessionStorage.setItem('userInfo', JSON.stringify(result.user));
//           Cookies.set('username', result.user.username, { expires: 1 });
//           Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });

//           if (onLoginSuccess) onLoginSuccess(result.user);
//           setTimeout(() => {
//             window.location.href = '/dashboard';
//           }, 2000);
//         } else {
//           const otpCode = generateOtp();
//           setGeneratedOtp(otpCode);

//           if (!result.sessionId) {
//             setError('Session ID not found in HRldap response. Using user ID as fallback.');
//           }

//           try {
//             await sendOtpSms(otpCode, result.user.mobileNo, result.sessionId || result.user.userId);
//             setOtpPhase(true);
//             setVerifiedUser(result.user);
//             sessionStorage.setItem('userInfo', JSON.stringify(result.user));
//             Cookies.set('username', result.user.username, { expires: 1 });
//             Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
//           } catch (smsError) {
//             setError(smsError.message || 'Failed to send OTP. Please try again.');
//             setOtpPhase(true); // Still proceed to OTP phase even if SMS fails,
//             // allowing user to resend or contact support.
//             setVerifiedUser(result.user);
//             sessionStorage.setItem('userInfo', JSON.stringify(result.user));
//             Cookies.set('username', result.user.username, { expires: 1 });
//             Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
//           }
//         }
//       } else {
//         setError('Invalid credentials. Please try again.');
//       }
//     } catch (error) {
//       setError(error.message || 'Login failed. Please try again.');
//     } finally {
//       setLoading(false);
//     }
//   };

//   const handleOtpSuccess = (data) => {
//     const { user, trustDevice } = data;

//     if (trustDevice) {
//       addTrustedDevice(formData.username);
//     }

//     setSuccess(true);
//     if (onLoginSuccess) onLoginSuccess(user);
//     setTimeout(() => {
//       window.location.href = '/dashboard';
//     }, 2000);
//   };

//   const handleOtpResend = async () => {
//     setError('');
//     setSuccess(false);

//     try {
//       const newOtp = generateOtp();
//       setGeneratedOtp(newOtp);
//       await sendOtpSms(newOtp, mobileNo, sessionId);
//       setSuccess(true);
//       setTimeout(() => setSuccess(false), 3000);
//     } catch (error) {
//       setError(error.message || 'Failed to resend OTP. Please try again.');
//     }
//   };

//   const handleClickShowPassword = () => setShowPassword(!showPassword);

//   useEffect(() => {
//     if (formData.username) {
//       try {
//         const devices = JSON.parse(localStorage.getItem(`trusted_devices_${formData.username}`) || '[]');
//         setTrustedDevices(devices);
//       } catch (error) {
//         console.error('Error loading trusted devices:', error);
//         setTrustedDevices([]);
//       }
//     }
//   }, [formData.username]);

//   const formatDate = (timestamp) => {
//     return new Date(timestamp).toLocaleDateString('en-US', {
//       year: 'numeric',
//       month: 'short',
//       day: 'numeric'
//     });
//   };

//   return (
//     &lt;Box sx={{ width: '100%' }}>
//       {!otpPhase &amp;&amp; (
//         &lt;Box component="form" onSubmit={handleSubmit}>
//           {error &amp;&amp; (
//             &lt;Alert severity="error" sx={{ mb: 3, borderRadius: 2 }}>
//               {error}
//             &lt;/Alert>
//           )}

//           {success &amp;&amp; (
//             &lt;Alert severity="success" sx={{ mb: 3, borderRadius: 2 }}>
//               {isTrustedDevice ? 'Welcome back! Trusted device verified.' : 'Login successful!'}
//             &lt;/Alert>
//           )}

//           &lt;Box sx={{ mb: 3 }}>
//             &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Username&lt;/Typography>
//             &lt;TextField
//               fullWidth
//               name="username"
//               value={formData.username}
//               onChange={handleChange}
//               placeholder="Enter your username"
//               disabled={loading}
//               InputProps={{
//                 startAdornment: (
//                   &lt;InputAdornment position="start">
//                     &lt;Person sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
//                   &lt;/InputAdornment>
//                 ),
//               }}
//               sx={{
//                 '&amp; .MuiOutlinedInput-root': {
//                   borderRadius: 2
//                 }
//               }}
//             />
//           &lt;/Box>

//           &lt;Box sx={{ mb: 4 }}>
//             &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Password&lt;/Typography>
//             &lt;TextField
//               fullWidth
//               name="password"
//               type={showPassword ? 'text' : 'password'}
//               value={formData.password}
//               onChange={handleChange}
//               placeholder="Enter your password"
//               disabled={loading}
//               InputProps={{
//                 startAdornment: (
//                   &lt;InputAdornment position="start">
//                     &lt;Lock sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
//                   &lt;/InputAdornment>
//                 ),
//                 endAdornment: (
//                   &lt;InputAdornment position="end">
//                     &lt;IconButton onClick={handleClickShowPassword} edge="end" disabled={loading}>
//                       {showPassword ? &lt;VisibilityOff /> : &lt;Visibility />}
//                     &lt;/IconButton>
//                   &lt;/InputAdornment>
//                 ),
//               }}
//               sx={{
//                 '&amp; .MuiOutlinedInput-root': {
//                   borderRadius: 2
//                 }
//               }}
//             />
//           &lt;/Box>

//           {formData.username &amp;&amp; trustedDevices.length > 0 &amp;&amp; (
//             &lt;Box sx={{ mb: 3 }}>
//               &lt;Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
//                 &lt;Shield sx={{ color: '#10b981', mr: 1, fontSize: '1rem' }} />
//                 &lt;Typography variant="body2" sx={{ color: '#10b981', fontWeight: 500 }}>
//                   Trusted Devices ({trustedDevices.length})
//                 &lt;/Typography>
//                 &lt;Button
//                   size="small"
//                   onClick={() => setShowTrustDialog(true)}
//                   sx={{ ml: 'auto', textTransform: 'none', fontSize: '0.75rem' }}
//                 >
//                   Manage
//                 &lt;/Button>
//               &lt;/Box>
//               &lt;Typography variant="caption" sx={{ color: '#6b7280' }}>
//                 Skip verification on trusted devices for {TRUST_DURATION_DAYS} days
//               &lt;/Typography>
//             &lt;/Box>
//           )}

//           &lt;Button
//             type="submit"
//             fullWidth
//             disabled={loading || !formData.username || !formData.password}
//             sx={{
//               py: 1.5,
//               borderRadius: 2,
//               background: loading ? '#9ca3af' : 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',
//               color: 'white',
//               fontWeight: 600,
//               fontSize: '0.875rem',
//               textTransform: 'none',
//             }}
//           >
//             {loading || otpLoading ? (
//               &lt;Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
//                 &lt;CircularProgress size={20} sx={{ color: 'white' }} />
//                 &lt;span>{loading ? 'Signing In...' : 'Sending OTP...'}&lt;/span>
//               &lt;/Box>
//             ) : (
//               &lt;span style={{ color: 'white' }}>Sign In&lt;/span>
//             )}
//           &lt;/Button>

//           {subtitle &amp;&amp; &lt;Box sx={{ mt: 3, textAlign: 'center' }}>{subtitle}&lt;/Box>}
//         &lt;/Box>
//       )}

//       {otpPhase &amp;&amp; (
//         &lt;OtpVerification
//           verifiedUser={verifiedUser}
//           onOtpSuccess={handleOtpSuccess}
//           onResendOtp={handleOtpResend}
//           phoneNumber={mobileNo}
//           generatedOtp={generatedOtp}
//           otpLoading={otpLoading}
//           trustDurationDays={TRUST_DURATION_DAYS}
//           sessionId={sessionId}
//         />
//       )}

//       &lt;Dialog
//         open={showTrustDialog}
//         onClose={() => setShowTrustDialog(false)}
//         maxWidth="sm"
//         fullWidth
//       >
//         &lt;DialogTitle>
//           &lt;Box sx={{ display: 'flex', alignItems: 'center' }}>
//             &lt;DevicesOther sx={{ mr: 1 }} />
//             Trusted Devices
//           &lt;/Box>
//         &lt;/DialogTitle>
//         &lt;DialogContent>
//           {trustedDevices.length === 0 ? (
//             &lt;Typography color="textSecondary">
//               No trusted devices found.
//             &lt;/Typography>
//           ) : (
//             &lt;Box>
//               &lt;Typography variant="body2" sx={{ mb: 2, color: '#6b7280' }}>
//                 These devices can skip OTP verification until they expire.
//               &lt;/Typography>
//               {trustedDevices.map((device, index) => (
//                 &lt;Box
//                   key={device.fingerprint}
//                   sx={{
//                     p: 2,
//                     border: '1px solid #e5e7eb',
//                     borderRadius: 2,
//                     mb: 2
//                   }}
//                 >
//                   &lt;Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
//                     &lt;Box sx={{ flex: 1 }}>
//                       &lt;Typography variant="subtitle2" sx={{ fontWeight: 600 }}>
//                         {getDeviceInfoString(device.deviceInfo)}
//                       &lt;/Typography>
//                       &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
//                         Trusted on {formatDate(device.trustedAt)}
//                       &lt;/Typography>
//                       &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
//                         Expires on {formatDate(device.expiresAt)}
//                       &lt;/Typography>
//                       {device.fingerprint === generateDeviceFingerprint() &amp;&amp; (
//                         &lt;Chip
//                           label="Current Device"
//                           size="small"
//                           color="primary"
//                           sx={{ mt: 1 }}
//                         />
//                       )}
//                     &lt;/Box>
//                     &lt;Button
//                       size="small"
//                       color="error"
//                       onClick={() => removeTrustedDevice(formData.username, device.fingerprint)}
//                       sx={{ textTransform: 'none' }}
//                     >
//                       Remove
//                     &lt;/Button>
//                   &lt;/Box>
//                 &lt;/Box>
//               ))}
//             &lt;/Box>
//           )}
//         &lt;/DialogContent>
//         &lt;DialogActions>
//           &lt;Button onClick={() => setShowTrustDialog(false)}>
//             Close
//           &lt;/Button>
//         &lt;/DialogActions>
//       &lt;/Dialog>
//     &lt;/Box>
//   );
// };

// export default AuthLogin;


/**
 * @fileoverview Task Inbox component for displaying and managing tasks
 * @module src/views/authentication/auth/AuthLogin
 * @author Rakshana
 * @date 22/07/2025
 * @since 1.0.0
 */

import React, { useState, useEffect } from 'react';
import {
  Box,
  TextField,
  Button,
  InputAdornment,
  IconButton,
  Alert,
  CircularProgress,
  Typography,
  Dialog,
  DialogTitle,
  DialogContent,
  DialogActions,
  Chip
} from '@mui/material';
import { Visibility, VisibilityOff, Person, Lock, Shield, DevicesOther } from '@mui/icons-material';
// Import encryptECB and decryptGCM from the Encryption module
import { authenticateUser, encryptECB, decryptGCM } from 'src/components/Encryption/Encryption';
import Cookies from 'js-cookie';
import OtpVerification from './OTPVerification';
import { HostName } from "src/assets/host/Host";

// Placeholder for validateJsonData function.
// If it's defined elsewhere, ensure it's imported correctly.
// Assuming it's a simple JSON validation, here's a basic one:
const validateJsonData = (data) => {
  try {
    const parsed = JSON.parse(data);
    // Add specific checks if needed for Loginotp API response validation
    if (parsed.message) {
      return parsed;
    }
    // Default success message if message field is absent but parsing is successful
    return { message: "OTP record inserted successfully", ...parsed };
  } catch (e) {
    return { message: "Invalid JSON format received", raw: data };
  }
};


const AuthLogin = ({ subtitle, onLoginSuccess }) => {
  const [formData, setFormData] = useState({ username: '', password: '' });
  const [mobileNo, setMobileNo] = useState('');
  const [sessionId, setSessionId] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);
  const [otpPhase, setOtpPhase] = useState(false);
  const [verifiedUser, setVerifiedUser] = useState(null);
  const [generatedOtp, setGeneratedOtp] = useState(''); // This will now hold the OTP from the SendOTP API response
  const [otpLoading, setOtpLoading] = useState(false);
  const [isTrustedDevice, setIsTrustedDevice] = useState(false);
  const [showTrustDialog, setShowTrustDialog] = useState(false);
  const [trustedDevices, setTrustedDevices] = useState([]);
  const TRUST_DURATION_DAYS = 30;
  const API_TOKEN = 'HRFGVJISOVp1fncC';
  const ENCRYPTION_KEY = '7xPz!qL3vNc#eRb9Wm@f2Zh8Kd$gYp1B'; // Define the encryption key locally

  const generateDeviceFingerprint = () => {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    ctx.textBaseline = 'top';
    ctx.font = '14px Arial';
    ctx.fillText('Device fingerprint', 2, 2);

    const fingerprint = [
      navigator.userAgent,
      navigator.language,
      screen.width + 'x' + screen.height,
      new Date().getTimezoneOffset(),
      canvas.toDataURL(),
      navigator.hardwareConcurrency || 'unknown',
      navigator.deviceMemory || 'unknown'
    ].join('|');
    let hash = 0;
    for (let i = 0; i &lt; fingerprint.length; i++) {
      const char = fingerprint.charCodeAt(i);
      hash = ((hash &lt;&lt; 5) - hash) + char;
      hash = hash &amp; hash;
    }
    return Math.abs(hash).toString(16);
  };

  const getDeviceInfo = () => {
    const ua = navigator.userAgent;
    let deviceType = 'Unknown Device';
    let browser = 'Unknown Browser';

    if (/Mobile|Android|iPhone|iPad/.test(ua)) {
      if (/iPhone/.test(ua)) deviceType = 'iPhone';
      else if (/iPad/.test(ua)) deviceType = 'iPad';
      else if (/Android/.test(ua)) deviceType = 'Android Device';
      else deviceType = 'Mobile Device';
    } else {
      deviceType = 'Desktop';
    }

    if (/Chrome/.test(ua)) browser = 'Chrome';
    else if (/Firefox/.test(ua)) browser = 'Firefox';
    else if (/Safari/.test(ua)) browser = 'Safari';
    else if (/Edge/.test(ua)) browser = 'Edge';

    return `${deviceType} - ${browser}`;
  };

  const getDeviceInfoString = (deviceInfo) => {
    if (typeof deviceInfo === 'string') {
      return deviceInfo;
    } else if (typeof deviceInfo === 'object' &amp;&amp; deviceInfo !== null) {
      const { browser = 'Unknown Browser', os = 'Unknown OS', screen = '', language = '' } = deviceInfo;
      return `${os} - ${browser}`;
    } else {
      return 'Unknown Device';
    }
  };

  const checkTrustedDevice = (username) => {
    const deviceFingerprint = generateDeviceFingerprint();
    const trustedDevicesData = localStorage.getItem(`trusted_devices_${username}`);

    if (trustedDevicesData) {
      try {
        const devices = JSON.parse(trustedDevicesData);
        const currentTime = new Date().getTime();
        const validDevices = devices.filter(device =>
          currentTime &lt; device.expiresAt
        );
        localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(validDevices));
        setTrustedDevices(validDevices);
        const trustedDevice = validDevices.find(device =>
          device.fingerprint === deviceFingerprint
        );

        return !!trustedDevice;
      } catch (error) {
        localStorage.removeItem(`trusted_devices_${username}`);
        return false;
      }
    }
    return false;
  };

  const addTrustedDevice = (username) => {
    const deviceFingerprint = generateDeviceFingerprint();
    const deviceInfo = getDeviceInfo();
    const currentTime = new Date().getTime();
    const expiresAt = currentTime + (TRUST_DURATION_DAYS * 24 * 60 * 60 * 1000);

    try {
      const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
      const filteredDevices = existingDevices.filter(device =>
        device.fingerprint !== deviceFingerprint
      );

      const newDevice = {
        fingerprint: deviceFingerprint,
        deviceInfo,
        trustedAt: currentTime,
        expiresAt,
        location: 'Current Location'
      };

      const updatedDevices = [...filteredDevices, newDevice];
      localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
      setTrustedDevices(updatedDevices);
    } catch (error) {
    }
  };

  const removeTrustedDevice = (username, fingerprint) => {
    try {
      const existingDevices = JSON.parse(localStorage.getItem(`trusted_devices_${username}`) || '[]');
      const updatedDevices = existingDevices.filter(device =>
        device.fingerprint !== fingerprint
      );
      localStorage.setItem(`trusted_devices_${username}`, JSON.stringify(updatedDevices));
      setTrustedDevices(updatedDevices);
    } catch (error) {
    }
  };



  const sendOtpSms = async (mobileNumber, sessionId) => { // Removed otpCode parameter
    try {
      setOtpLoading(true);

      if (!mobileNumber || !/^\d{10,}$/.test(mobileNumber.replace(/\D/g, ''))) {
        throw new Error('Invalid or missing mobile number');
      }

      if (!sessionId) {
        throw new Error('Session ID not provided for OTP request. Please try logging in again.');
      }

      let actualOtpSentToMobile = '';

      // --- NEW OTP SENDING LOGIC ---
      const encryptedMobileNo = encryptECB(mobileNumber.replace(/\D/g, ''), ENCRYPTION_KEY);
      const otpSendApiUrl = 'https://wftest1.iitm.ac.in:7000/SendOTP';
      const otpSendRequestBody = {
        token: API_TOKEN,
        send_to: encryptedMobileNo,
      };

      try {
         const headers = {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${Cookies.get('HRToken')}`,
      };
        const otpSendResponse = await fetch(otpSendApiUrl, {
          method: 'POST',
           headers: headers,
          body: JSON.stringify(otpSendRequestBody)
        });

        if (!otpSendResponse.ok) {
          const errorText = await otpSendResponse.text();
          throw new Error(`Failed to send OTP via new API: HTTP error! status: ${otpSendResponse.status} - ${errorText}`);
        }

        const otpSendEncryptedData = await otpSendResponse.json();
        if (!otpSendEncryptedData.Data) {
            throw new Error('No encrypted data received from SendOTP API');
        }

        // Decrypt the response from the SendOTP API
        const decryptedSendOtpResponse = await decryptGCM(otpSendEncryptedData.Data, ENCRYPTION_KEY);
        const parsedSendOtpResponse = JSON.parse(decryptedSendOtpResponse);

        if (parsedSendOtpResponse.otp_sent) {
          actualOtpSentToMobile = parsedSendOtpResponse.otp_sent;
        } else {
          throw new Error('OTP not found in the decrypted SendOTP API response (otp_sent field missing).');
        }

      } catch (otpSendError) {
        throw new Error(otpSendError.message || 'Failed to initiate OTP delivery or process its response.');
      }

      setGeneratedOtp(actualOtpSentToMobile);

      const requestBody = {
        token: API_TOKEN,
        username: formData.username,
        mobileno: parseInt(mobileNumber.replace(/\D/g, '')),
        session_id: sessionId,
        otp: parseInt(actualOtpSentToMobile), // Use the OTP received from the SendOTP API for database insertion
        otpsendon: new Date().toISOString(),
        otpverifiedon: null,
        status: 0,
        updatedon: new Date().toISOString()
      };

      const headers = {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${Cookies.get('HRToken')}`,
      };

      const response = await fetch(`${HostName}/Loginotp`, {
        method: 'POST',
        headers: headers,
        body: JSON.stringify(requestBody)
      });

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status} from Loginotp API`);
      }

      const encryptedLoginotpData = await response.json();
      if (!encryptedLoginotpData.Data) {
        throw new Error('No encrypted data received from Loginotp API');
      }

      // Decrypt the response from the Loginotp API
      const decryptedLoginotpData = await decryptGCM(encryptedLoginotpData.Data, ENCRYPTION_KEY);
      const result = validateJsonData(decryptedLoginotpData);

      if (result.message !== 'OTP record inserted successfully') {
        throw new Error('Failed to insert OTP record: ' + (result.message || 'Unknown error'));
      }

      return true;
    } catch (error) {
      throw new Error(error.message || 'Failed to send OTP or record OTP status.');
    } finally {
      setOtpLoading(false);
    }
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
    if (error) setError('');
  };

  const handleSubmit = async (e) => {
    e.preventDefault();

    if (!formData.username || !formData.password) {
      setError('Please enter both username and password');
      return;
    }

    setLoading(true);
    setError('');

    try {
      const result = await authenticateUser(formData.username, formData.password);

      if (result.success) {
        if (!result.user.mobileNo) {
          setError('Mobile number not found for this user. Please contact support.');
          setLoading(false);
          return;
        }

        setMobileNo(result.user.mobileNo);
        setSessionId(result.sessionId || result.user.userId);
        const isDeviceTrusted = checkTrustedDevice(formData.username);
        setIsTrustedDevice(isDeviceTrusted);

        if (isDeviceTrusted) {
          setSuccess(true);
          setVerifiedUser(result.user);
          sessionStorage.setItem('userInfo', JSON.stringify(result.user));
          Cookies.set('username', result.user.username, { expires: 1 });
          Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });

          if (onLoginSuccess) onLoginSuccess(result.user);
          setTimeout(() => {
            window.location.href = '/dashboard';
          }, 2000);
        } else {
          if (!result.sessionId) {
          }

          try {
            // Call sendOtpSms without a frontend-generated OTP; it will fetch and set the OTP
            await sendOtpSms(result.user.mobileNo, result.sessionId || result.user.userId);
            setOtpPhase(true);
            setVerifiedUser(result.user);
            sessionStorage.setItem('userInfo', JSON.stringify(result.user));
            Cookies.set('username', result.user.username, { expires: 1 });
            Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
          } catch (smsError) {
            setError(smsError.message || 'Failed to send OTP. Please try again.');
            // Still proceed to OTP phase even if SMS fails, if desired,
            // allowing user to resend or contact support.
            setOtpPhase(true);
            setVerifiedUser(result.user);
            sessionStorage.setItem('userInfo', JSON.stringify(result.user));
            Cookies.set('username', result.user.username, { expires: 1 });
            Cookies.set('session_id', result.sessionId || result.user.userId, { expires: 1 });
          }
        }
      } else {
        setError('Invalid credentials. Please try again.');
      }
    } catch (error) {
      setError(error.message || 'Login failed. Please try again.');
    } finally {
      setLoading(false);
    }
  };

  const handleOtpSuccess = (data) => {
    const { user, trustDevice } = data;

    if (trustDevice) {
      addTrustedDevice(formData.username);
    }

    setSuccess(true);
    if (onLoginSuccess) onLoginSuccess(user);
    setTimeout(() => {
      window.location.href = '/dashboard';
    }, 2000);
  };

  const handleOtpResend = async () => {
    setError('');
    setSuccess(false);

    try {
      // Call sendOtpSms without a frontend-generated OTP; it will fetch and set the OTP
      await sendOtpSms(mobileNo, sessionId);
      setSuccess(true);
      setTimeout(() => setSuccess(false), 3000);
    } catch (error) {
      setError(error.message || 'Failed to resend OTP. Please try again.');
    }
  };

  const handleClickShowPassword = () => setShowPassword(!showPassword);

  useEffect(() => {
    if (formData.username) {
      try {
        const devices = JSON.parse(localStorage.getItem(`trusted_devices_${formData.username}`) || '[]');
        setTrustedDevices(devices);
      } catch (error) {
        setTrustedDevices([]);
      }
    }
  }, [formData.username]);

  const formatDate = (timestamp) => {
    return new Date(timestamp).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'short',
      day: 'numeric'
    });
  };

  return (
    &lt;Box sx={{ width: '100%' }}>
      {!otpPhase &amp;&amp; (
        &lt;Box component="form" onSubmit={handleSubmit}>
          {error &amp;&amp; (
            &lt;Alert severity="error" sx={{ mb: 3, borderRadius: 2 }}>
              {error}
            &lt;/Alert>
          )}

          {success &amp;&amp; (
            &lt;Alert severity="success" sx={{ mb: 3, borderRadius: 2 }}>
              {isTrustedDevice ? 'Welcome back! Trusted device verified.' : 'Login successful!'}
            &lt;/Alert>
          )}

          &lt;Box sx={{ mb: 3 }}>
            &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Username&lt;/Typography>
            &lt;TextField
              fullWidth
              name="username"
              value={formData.username}
              onChange={handleChange}
              placeholder="Enter your username"
              disabled={loading}
              InputProps={{
                startAdornment: (
                  &lt;InputAdornment position="start">
                    &lt;Person sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
                  &lt;/InputAdornment>
                ),
              }}
              sx={{
                '&amp; .MuiOutlinedInput-root': {
                  borderRadius: 2
                }
              }}
            />
          &lt;/Box>

          &lt;Box sx={{ mb: 4 }}>
            &lt;Typography variant="body2" sx={{ mb: 1, fontWeight: 500 }}>Password&lt;/Typography>
            &lt;TextField
              fullWidth
              name="password"
              type={showPassword ? 'text' : 'password'}
              value={formData.password}
              onChange={handleChange}
              placeholder="Enter your password"
              disabled={loading}
              InputProps={{
                startAdornment: (
                  &lt;InputAdornment position="start">
                    &lt;Lock sx={{ color: '#9ca3af', fontSize: '1.25rem' }} />
                  &lt;/InputAdornment>
                ),
                endAdornment: (
                  &lt;InputAdornment position="end">
                    &lt;IconButton onClick={handleClickShowPassword} edge="end" disabled={loading}>
                      {showPassword ? &lt;VisibilityOff /> : &lt;Visibility />}
                    &lt;/IconButton>
                  &lt;/InputAdornment>
                ),
              }}
              sx={{
                '&amp; .MuiOutlinedInput-root': {
                  borderRadius: 2
                }
              }}
            />
          &lt;/Box>

          {formData.username &amp;&amp; trustedDevices.length > 0 &amp;&amp; (
            &lt;Box sx={{ mb: 3 }}>
              &lt;Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                &lt;Shield sx={{ color: '#10b981', mr: 1, fontSize: '1rem' }} />
                &lt;Typography variant="body2" sx={{ color: '#10b981', fontWeight: 500 }}>
                  Trusted Devices ({trustedDevices.length})
                &lt;/Typography>
                &lt;Button
                  size="small"
                  onClick={() => setShowTrustDialog(true)}
                  sx={{ ml: 'auto', textTransform: 'none', fontSize: '0.75rem' }}
                >
                  Manage
                &lt;/Button>
              &lt;/Box>
              &lt;Typography variant="caption" sx={{ color: '#6b7280' }}>
                Skip verification on trusted devices for {TRUST_DURATION_DAYS} days
              &lt;/Typography>
            &lt;/Box>
          )}

          &lt;Button
            type="submit"
            fullWidth
            disabled={loading || !formData.username || !formData.password}
            sx={{
              py: 1.5,
              borderRadius: 2,
              background: loading ? '#9ca3af' : 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',
              color: 'white',
              fontWeight: 600,
              fontSize: '0.875rem',
              textTransform: 'none',
            }}
          >
            {loading || otpLoading ? (
              &lt;Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
                &lt;CircularProgress size={20} sx={{ color: 'white' }} />
                &lt;span>{loading ? 'Signing In...' : 'Sending OTP...'}&lt;/span>
              &lt;/Box>
            ) : (
              &lt;span style={{ color: 'white' }}>Sign In&lt;/span>
            )}
          &lt;/Button>

          {subtitle &amp;&amp; &lt;Box sx={{ mt: 3, textAlign: 'center' }}>{subtitle}&lt;/Box>}
        &lt;/Box>
      )}

      {otpPhase &amp;&amp; (
        &lt;OtpVerification
          verifiedUser={verifiedUser}
          onOtpSuccess={handleOtpSuccess}
          onResendOtp={handleOtpResend}
          phoneNumber={mobileNo}
          generatedOtp={generatedOtp} // This now comes from the SendOTP API response
          otpLoading={otpLoading}
          trustDurationDays={TRUST_DURATION_DAYS}
          sessionId={sessionId}
        />
      )}

      &lt;Dialog
        open={showTrustDialog}
        onClose={() => setShowTrustDialog(false)}
        maxWidth="sm"
        fullWidth
      >
        &lt;DialogTitle>
          &lt;Box sx={{ display: 'flex', alignItems: 'center' }}>
            &lt;DevicesOther sx={{ mr: 1 }} />
            Trusted Devices
          &lt;/Box>
        &lt;/DialogTitle>
        &lt;DialogContent>
          {trustedDevices.length === 0 ? (
            &lt;Typography color="textSecondary">
              No trusted devices found.
            &lt;/Typography>
          ) : (
            &lt;Box>
              &lt;Typography variant="body2" sx={{ mb: 2, color: '#6b7280' }}>
                These devices can skip OTP verification until they expire.
              &lt;/Typography>
              {trustedDevices.map((device, index) => (
                &lt;Box
                  key={device.fingerprint}
                  sx={{
                    p: 2,
                    border: '1px solid #e5e7eb',
                    borderRadius: 2,
                    mb: 2
                  }}
                >
                  &lt;Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                    &lt;Box sx={{ flex: 1 }}>
                      &lt;Typography variant="subtitle2" sx={{ fontWeight: 600 }}>
                        {getDeviceInfoString(device.deviceInfo)}
                      &lt;/Typography>
                      &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
                        Trusted on {formatDate(device.trustedAt)}
                      &lt;/Typography>
                      &lt;Typography variant="caption" sx={{ color: '#6b7280', display: 'block' }}>
                        Expires on {formatDate(device.expiresAt)}
                      &lt;/Typography>
                      {device.fingerprint === generateDeviceFingerprint() &amp;&amp; (
                        &lt;Chip
                          label="Current Device"
                          size="small"
                          color="primary"
                          sx={{ mt: 1 }}
                        />
                      )}
                    &lt;/Box>
                    &lt;Button
                      size="small"
                      color="error"
                      onClick={() => removeTrustedDevice(formData.username, device.fingerprint)}
                      sx={{ textTransform: 'none' }}
                    >
                      Remove
                    &lt;/Button>
                  &lt;/Box>
                &lt;/Box>
              ))}
            &lt;/Box>
          )}
        &lt;/DialogContent>
        &lt;DialogActions>
          &lt;Button onClick={() => setShowTrustDialog(false)}>
            Close
          &lt;/Button>
        &lt;/DialogActions>
      &lt;/Dialog>
    &lt;/Box>
  );
};

export default AuthLogin;</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Wed Nov 05 2025 11:24:43 GMT+0530 (India Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
